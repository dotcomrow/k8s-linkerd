apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: linkerd-control-plane
  namespace: linkerd
spec:
  name: linkerd
  chart: linkerd-control-plane
  repo: https://helm.linkerd.io/stable
  version: 1.16.11
  targetNamespace: linkerd
  valuesContent: |-
    identity:
      externalCA: true
      issuer:
        scheme: kubernetes.io/tls
        tls:
          crtPEM: |
            {{ (lookup "v1" "Secret" "linkerd" "linkerd-identity-issuer").data."tls.crt" | b64dec }}
          keyPEM: |
            {{ (lookup "v1" "Secret" "linkerd" "linkerd-identity-issuer").data."tls.key" | b64dec }}
      trustAnchorsPEM: |
        {{ (lookup "v1" "Secret" "linkerd" "linkerd-trust-anchor").data."ca.crt" | b64dec }}
